<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ï†Ñ ÏÑ∏Í≥Ñ ÌïúÏù∏ ÏóÖÏ≤¥ Í≤ÄÏÉâ - Íµ≠Í∞Ä, ÎèÑÏãú, ÏóÖÏ¢ÖÎ≥ÑÎ°ú ÌïúÏù∏ ÏóÖÏ≤¥Î•º ÏâΩÍ≤å Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî">
    <meta name="keywords" content="ÌïúÏù∏ ÏóÖÏ≤¥, Ìï¥Ïô∏ ÌïúÏù∏, ÌïúÏãùÎãπ, ÌïúÏù∏ Ïª§ÎÆ§ÎãàÌã∞">
    <title>ÌïúÏù∏ ÏóÖÏ≤¥ Í≤ÄÏÉâ - Ï†Ñ ÏÑ∏Í≥Ñ ÌïúÏù∏ ÎπÑÏ¶àÎãàÏä§ ÎîîÎ†âÌÜ†Î¶¨</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />
    
    <style>
        /* ========== CSS Î¶¨ÏÖã Î∞è Í∏∞Î≥∏ Ïä§ÌÉÄÏùº ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            /* Î™®ÎçòÌïú ÏÉâÏÉÅ ÌåîÎ†àÌä∏ */
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #6366f1;
            --primary-light: #818cf8;
            --primary-dark: #4f46e5;
            --secondary-color: #8b5cf6;
            --accent-color: #ec4899;
            
            --text-dark: #1e293b;
            --text-light: #64748b;
            --text-muted: #94a3b8;
            
            --border-color: #e2e8f0;
            --bg-gray: #f8fafc;
            --bg-light: #ffffff;
            
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #3b82f6;
            
            --yellow-star: #fbbf24;
            
            /* Í∑∏Î¶ºÏûê */
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-full: 9999px;
        }
        
        body {
            font-family: "Inter", "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(to bottom, #f8fafc 0%, #ffffff 100%);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
            text-rendering: optimizeLegibility;
        }
        
        /* Ïà´Ïûê ÏµúÏ†ÅÌôî */
        .rating-value,
        .rating-count,
        .selected-badge,
        .distance-badge,
        .page-btn {
            font-variant-numeric: tabular-nums;
            font-feature-settings: "tnum" 1, "kern" 1;
        }
        
        /* ========== Ï†ëÍ∑ºÏÑ± ========== */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            text-decoration: none;
            z-index: 100;
            border-radius: 0 0 var(--border-radius-sm) 0;
        }
        
        .skip-link:focus {
            top: 0;
        }
        
        *:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* ========== Ìó§Îçî ========== */
        .header {
            background: var(--primary-gradient);
            color: white;
            padding: 3rem 1.5rem 4rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="white"/><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" fill="white"/><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="white"/></svg>') bottom center no-repeat;
            background-size: cover;
            opacity: 0.1;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        .header h1 {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
            letter-spacing: -0.03em;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .header p {
            font-size: 1.125rem;
            opacity: 0.95;
            font-weight: 400;
            letter-spacing: -0.01em;
        }
        
        /* ========== Ïª®ÌÖåÏù¥ÎÑà ========== */
        .container {
            max-width: 1280px;
            margin: -2rem auto 0;
            padding: 0 1.5rem 4rem;
            position: relative;
            z-index: 10;
        }
        
        /* ========== ÌïÑÌÑ∞ Ïª®Ìä∏Î°§ ========== */
        .controls {
            background: var(--bg-light);
            padding: 2rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        
        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .search-box input {
            width: 100%;
            padding: 1rem 1.25rem 1rem 3.25rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-full);
            font-size: 1rem;
            font-family: inherit;
            transition: var(--transition);
            background: var(--bg-gray);
        }
        
        .search-box input:focus {
            border-color: var(--primary-color);
            background: var(--bg-light);
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .search-box::before {
            content: 'üîç';
            position: absolute;
            left: 1.25rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.25rem;
            pointer-events: none;
        }
        
        .dropdowns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .dropdown-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
            letter-spacing: -0.01em;
        }
        
        .dropdown-group select {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 0.9375rem;
            font-family: inherit;
            cursor: pointer;
            transition: var(--transition);
            background: var(--bg-gray);
            font-weight: 500;
        }
        
        .dropdown-group select:disabled {
            background-color: #f1f5f9;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .dropdown-group select:focus {
            border-color: var(--primary-color);
            background: var(--bg-light);
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        /* ========== ÏóÖÏ¢Ö ÌïÑÌÑ∞ Ïπ© ========== */
        .category-label {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-dark);
            display: block;
        }
        
        .category-chips {
            display: flex;
            gap: 0.625rem;
            overflow-x: auto;
            padding: 0.5rem 0;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-light) var(--border-color);
        }
        
        .category-chips::-webkit-scrollbar {
            height: 6px;
        }
        
        .category-chips::-webkit-scrollbar-track {
            background: var(--bg-gray);
            border-radius: 3px;
        }
        
        .category-chips::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 3px;
        }
        
        .chip {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.625rem 1.25rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-full);
            background: var(--bg-light);
            cursor: pointer;
            white-space: nowrap;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: inherit;
            transition: var(--transition);
            user-select: none;
        }
        
        .chip:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }
        
        .chip[aria-checked="true"] {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-md);
        }
        
        .chip.all-chip {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            font-weight: 700;
        }
        
        .chip.all-chip[aria-checked="false"] {
            background: var(--bg-light);
            color: var(--text-dark);
            border-color: var(--border-color);
        }
        
        .chip-check {
            display: none;
            font-size: 0.75rem;
        }
        
        .chip[aria-checked="true"] .chip-check {
            display: inline;
        }
        
        /* ========== Í≤∞Í≥º Ìó§Îçî ========== */
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .result-count {
            font-size: 1rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 0.625rem;
            font-weight: 500;
        }
        
        .selected-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 28px;
            height: 28px;
            padding: 0 0.625rem;
            background: var(--primary-gradient);
            color: white;
            border-radius: var(--border-radius-full);
            font-size: 0.8125rem;
            font-weight: 700;
            animation: pulse 0.6s ease;
            box-shadow: var(--shadow-sm);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            background: var(--bg-gray);
            padding: 0.375rem;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-xs);
        }
        
        .view-btn {
            padding: 0.625rem 1.25rem;
            border: none;
            background: transparent;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: inherit;
            color: var(--text-light);
            transition: var(--transition-fast);
        }
        
        .view-btn[aria-pressed="true"] {
            background: var(--bg-light);
            color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }
        
        .view-btn:hover {
            color: var(--primary-color);
        }
        
        /* ========== Î°úÎî©/ÏóêÎü¨/Îπà ÏÉÅÌÉú ========== */
        .loading-state,
        .error-state,
        .empty-state {
            text-align: center;
            padding: 4rem 1.5rem;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 1.5rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-state {
            background: linear-gradient(135deg, #fef2f2 0%, #ffffff 100%);
            border: 2px solid #fecaca;
            border-radius: var(--border-radius-lg);
            padding: 3rem 2rem;
        }
        
        .error-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
        }
        
        .error-message {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--error-color);
            margin-bottom: 0.75rem;
        }
        
        .error-details {
            color: #991b1b;
            font-size: 1rem;
        }
        
        .empty-icon {
            font-size: 5rem;
            margin-bottom: 1.5rem;
        }
        
        .empty-message {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.75rem;
        }
        
        .empty-hint {
            font-size: 1rem;
            color: var(--text-light);
        }
        
        /* ========== ÌèâÏ†ê Ïä§ÌÉÄÏùº ========== */
        .rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            margin-bottom: 0.75rem;
        }
        
        .rating-stars {
            display: flex;
            align-items: center;
            gap: 0.125rem;
            color: var(--yellow-star);
            font-size: 1rem;
        }
        
        .rating-value {
            font-weight: 700;
            color: var(--text-dark);
        }
        
        .rating-count {
            color: var(--text-muted);
            font-size: 0.8125rem;
        }
        
        .distance-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.375rem 0.75rem;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: var(--border-radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            color: #166534;
            box-shadow: var(--shadow-xs);
        }
        
        /* ========== Ïπ¥Îìú Î∑∞ ========== */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.75rem;
        }
        
        .business-card {
            background: var(--bg-light);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            border: 1px solid var(--border-color);
        }
        
        .business-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-light);
        }
        
        .card-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background: linear-gradient(135deg, var(--bg-gray) 0%, #e2e8f0 100%);
            transition: opacity 0.3s ease;
        }
        
        .card-image[data-src]:not([src]),
        .card-image.lazy-loading {
            background: linear-gradient(
                90deg,
                var(--bg-gray) 0%,
                #e2e8f0 20%,
                var(--bg-gray) 40%,
                var(--bg-gray) 100%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s ease-in-out infinite;
            opacity: 0.7;
        }
        
        .card-image.loaded {
            opacity: 1;
            animation: none;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .card-content {
            padding: 1.75rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .card-content h3 {
            font-size: 1.375rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--text-dark);
            letter-spacing: -0.02em;
        }
        
        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .tag {
            display: inline-block;
            padding: 0.375rem 0.875rem;
            background: var(--primary-gradient);
            color: white;
            border-radius: var(--border-radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            box-shadow: var(--shadow-xs);
            letter-spacing: 0.02em;
        }
        
        .card-feature {
            font-style: italic;
            color: var(--text-light);
            font-size: 0.9375rem;
            margin-bottom: 1.25rem;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .card-info {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
            font-size: 0.9375rem;
            color: var(--text-dark);
        }
        
        .info-item {
            display: flex;
            align-items: flex-start;
            gap: 0.625rem;
            line-height: 1.5;
        }
        
        .info-icon {
            min-width: 20px;
            font-size: 1.125rem;
            margin-top: 1px;
        }
        
        /* ========== ÏõêÌòï Ïï°ÏÖò Î≤ÑÌäº (Î™®Îçò ÎîîÏûêÏù∏) ========== */
        .card-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            margin-top: auto;
            padding-top: 1.25rem;
            border-top: 2px solid var(--bg-gray);
        }
        
        .action-btn {
            position: relative;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            background: var(--bg-gray);
            color: var(--text-dark);
            cursor: pointer;
            font-size: 1.5rem;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            box-shadow: var(--shadow-xs);
        }
        
        .action-btn::after {
            content: attr(aria-label);
            position: absolute;
            bottom: -32px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.375rem 0.75rem;
            border-radius: var(--border-radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: var(--transition-fast);
            z-index: 10;
        }
        
        .action-btn:hover {
            transform: translateY(-4px) scale(1.1);
            box-shadow: var(--shadow-lg);
        }
        
        .action-btn:hover::after {
            opacity: 1;
        }
        
        .action-btn:active {
            transform: translateY(-2px) scale(1.05);
        }
        
        /* Í∞úÎ≥Ñ Î≤ÑÌäº ÏÉâÏÉÅ */
        .action-btn.phone {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .action-btn.map {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        
        .action-btn.email {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .action-btn.website {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
        }
        
        /* ========== ÌÖåÏù¥Î∏î Î∑∞ ========== */
        .table-container {
            background: var(--bg-light);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        .business-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .business-table thead {
            background: linear-gradient(135deg, var(--bg-gray) 0%, #f1f5f9 100%);
        }
        
        .business-table th {
            padding: 1.25rem 1rem;
            text-align: left;
            font-weight: 700;
            font-size: 0.875rem;
            color: var(--text-dark);
            border-bottom: 2px solid var(--border-color);
            white-space: nowrap;
            letter-spacing: 0.02em;
        }
        
        .business-table td {
            padding: 1.25rem 1rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.9375rem;
        }
        
        .business-table tbody tr {
            transition: var(--transition-fast);
        }
        
        .business-table tbody tr:hover {
            background: var(--bg-gray);
        }
        
        .table-image {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: var(--border-radius-md);
            transition: opacity 0.3s ease;
            box-shadow: var(--shadow-sm);
        }
        
        .table-image[data-src]:not([src]),
        .table-image.lazy-loading {
            background: linear-gradient(90deg, var(--bg-gray) 0%, #e2e8f0 50%, var(--bg-gray) 100%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            opacity: 0.7;
        }
        
        .table-image.loaded {
            opacity: 1;
            animation: none;
        }
        
        .table-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.375rem;
        }
        
        .table-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: nowrap;
        }
        
        /* ÌÖåÏù¥Î∏îÏö© ÏõêÌòï Î≤ÑÌäº */
        .table-action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--bg-gray);
            cursor: pointer;
            font-size: 1.125rem;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: var(--text-dark);
            box-shadow: var(--shadow-xs);
        }
        
        .table-action-btn:hover {
            transform: scale(1.15);
            box-shadow: var(--shadow-md);
        }
        
        .table-action-btn.phone {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .table-action-btn.map {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        
        .table-action-btn.email {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .table-action-btn.website {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
        }
        
        /* ========== ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò ========== */
        .pagination-wrapper {
            margin-top: 2.5rem;
            padding-bottom: 2rem;
        }
        
        .items-per-page {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .items-per-page select {
            padding: 0.625rem 2.5rem 0.625rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 0.875rem;
            font-family: inherit;
            cursor: pointer;
            background: var(--bg-light);
            font-weight: 600;
            transition: var(--transition);
        }
        
        .items-per-page select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.625rem;
            flex-wrap: wrap;
        }
        
        .page-btn {
            min-width: 44px;
            height: 44px;
            padding: 0.625rem 0.875rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            background: var(--bg-light);
            cursor: pointer;
            font-size: 0.9375rem;
            font-weight: 700;
            font-family: inherit;
            color: var(--text-dark);
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .page-btn:hover:not(:disabled) {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }
        
        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        .page-btn[aria-current="page"] {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-md);
        }
        
        .page-ellipsis {
            padding: 0.625rem;
            color: var(--text-muted);
            font-weight: 600;
        }
        
        /* ========== ÏúÑÏπò ÏïåÎ¶º ========== */
        .location-notice {
            background: #eff6ff;
            border: 2px solid #bfdbfe;
            border-radius: var(--border-radius-md);
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
            font-size: 0.9375rem;
            color: #1e40af;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
            font-weight: 500;
        }
        
        .location-notice.success {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: #86efac;
            color: #166534;
        }
        
        .location-notice.error {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-color: #fca5a5;
            color: #991b1b;
        }
        
        .location-notice.info {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-color: #93c5fd;
            color: #1e40af;
        }
        
        .location-btn {
            margin-left: auto;
            padding: 0.625rem 1.25rem;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: var(--border-radius-full);
            font-size: 0.875rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }
        
        .location-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .location-btn:active {
            transform: translateY(0);
        }
        
        /* ========== Î∞òÏùëÌòï ÎîîÏûêÏù∏ ========== */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.75rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .dropdowns {
                grid-template-columns: 1fr;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
            }
            
            .results-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .controls {
                padding: 1.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .view-toggle {
                display: none;
            }
            
            .table-container {
                display: none;
            }
            
            .action-btn {
                width: 48px;
                height: 48px;
                font-size: 1.25rem;
            }
            
            .card-actions {
                flex-wrap: wrap;
            }
        }
        
        /* ========== Ïù∏ÏáÑ Ïä§ÌÉÄÏùº ========== */
        @media print {
            body {
                background: white;
            }
            
            .controls,
            .view-toggle,
            .pagination-wrapper,
            .skip-link,
            .location-notice {
                display: none !important;
            }
            
            .header {
                background: none;
                color: black;
                border-bottom: 2px solid black;
            }
            
            .business-card {
                break-inside: avoid;
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
                margin-bottom: 1rem;
            }
            
            .card-actions {
                display: none;
            }
        }
        
        /* ========== Ïà®ÍπÄ ÌÅ¥ÎûòÏä§ ========== */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Î≥∏Î¨∏ÏúºÎ°ú Î∞îÎ°úÍ∞ÄÍ∏∞</a>
    
    <header class="header">
        <div class="header-content">
            <h1>üåè Ï†Ñ ÏÑ∏Í≥Ñ ÌïúÏù∏ ÏóÖÏ≤¥ Í≤ÄÏÉâ</h1>
            <p>Íµ≠Í∞Ä, ÎèÑÏãú, ÏóÖÏ¢ÖÎ≥ÑÎ°ú ÌïúÏù∏ ÏóÖÏ≤¥Î•º ÏâΩÍ≤å Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî</p>
        </div>
    </header>
    
    <main class="container" id="main-content" role="main">
        <section class="controls" role="search" aria-label="Í≤ÄÏÉâ ÌïÑÌÑ∞">
            <div id="location-notice" class="location-notice hidden" role="status" aria-live="polite"></div>
            
            <div class="search-box">
                <label for="search-input" class="sr-only">ÏóÖÏ≤¥ Í≤ÄÏÉâ</label>
                <input 
                    type="text" 
                    id="search-input" 
                    placeholder="ÏóÖÏ≤¥Î™Ö, Ï£ºÏÜå, ÌäπÏßïÏúºÎ°ú Í≤ÄÏÉâ..." 
                    aria-label="ÏóÖÏ≤¥Î™Ö, Ï£ºÏÜå, ÌäπÏßïÏúºÎ°ú Í≤ÄÏÉâ"
                    autocomplete="off"
                />
            </div>
            
            <div class="dropdowns">
                <div class="dropdown-group">
                    <label for="country-select">Íµ≠Í∞Ä</label>
                    <select id="country-select" aria-label="Íµ≠Í∞Ä ÏÑ†ÌÉù">
                        <option value="">Ï†ÑÏ≤¥ Íµ≠Í∞Ä</option>
                    </select>
                </div>
                <div class="dropdown-group">
                    <label for="city-select">ÎèÑÏãú</label>
                    <select id="city-select" aria-label="ÎèÑÏãú ÏÑ†ÌÉù" disabled>
                        <option value="">Íµ≠Í∞ÄÎ•º Î®ºÏ†Ä ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                    </select>
                </div>
                <div class="dropdown-group">
                    <label for="sort-select">Ï†ïÎ†¨</label>
                    <select id="sort-select" aria-label="Ï†ïÎ†¨ Î∞©Ïãù ÏÑ†ÌÉù">
                        <option value="rating">ÌèâÏ†êÏàú</option>
                        <option value="reviews">ÌõÑÍ∏∞Ïàú</option>
                        <option value="distance">Í±∞Î¶¨Ïàú</option>
                    </select>
                </div>
            </div>
            
            <label class="category-label">ÏóÖÏ¢Ö</label>
            <div 
                class="category-chips" 
                role="group" 
                aria-label="ÏóÖÏ¢Ö ÏÑ†ÌÉù"
                id="category-chips"
            ></div>
        </section>
        
        <div class="results-header">
            <div class="result-count" role="status" aria-live="polite" id="result-count">
                Í≤ÄÏÉâ Í≤∞Í≥º: <strong>0Í∞ú</strong>
            </div>
            <div class="view-toggle" role="tablist" aria-label="Î≥¥Í∏∞ Î∞©Ïãù">
                <button 
                    class="view-btn" 
                    id="card-view-btn" 
                    role="tab"
                    aria-pressed="true"
                    aria-controls="results-container"
                >
                    Ïπ¥Îìú Î≥¥Í∏∞
                </button>
                <button 
                    class="view-btn" 
                    id="table-view-btn"
                    role="tab"
                    aria-pressed="false"
                    aria-controls="results-container"
                >
                    ÌÖåÏù¥Î∏î Î≥¥Í∏∞
                </button>
            </div>
        </div>
        
        <div id="results-container" role="region" aria-live="polite"></div>
        
        <div class="pagination-wrapper" id="pagination-wrapper"></div>
    </main>
    
    <script>
    (function() {
        'use strict';
        
        // ========== Ïú†Ìã∏Î¶¨Ìã∞ Ìï®Ïàò ==========
        
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function validateInput(value, maxLength = 100) {
            if (typeof value !== 'string') return false;
            if (value.length > maxLength) return false;
            const dangerousPatterns = /<script|javascript:|onerror=|onclick=/i;
            return !dangerousPatterns.test(value);
        }
        
        function logError(error, context) {
            console.error(`[${context}] Error:`, error);
        }
        
        function smoothScrollTo(element) {
            if (!element) return;
            const headerHeight = 100;
            const elementPosition = element.getBoundingClientRect().top + window.pageYOffset;
            const offsetPosition = elementPosition - headerHeight;
            
            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
        
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c;
        }
        
        function formatDistance(distance) {
            if (distance < 1) {
                return `${Math.round(distance * 1000)}m`;
            } else if (distance < 10) {
                return `${distance.toFixed(1)}km`;
            } else {
                return `${Math.round(distance)}km`;
            }
        }
        
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += '‚òÖ';
            }
            if (hasHalfStar) {
                stars += '‚òÖ';
            }
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                stars += '‚òÜ';
            }
            
            return stars;
        }
        
        // ========== Îç∞Ïù¥ÌÑ∞ ==========
        
        let businessData = [];
        
        // ‚ö†Ô∏è Ïó¨Í∏∞Ïóê Google Apps Script Ïõπ Ïï± URLÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî
        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycby3ewdRdV7NI4s8oMUznLAb-rO5genjjF0MfNDenCoeoRreQakSNXcnFoLHjeb5RZ6S1w/exec';
        
        async function fetchData() {
            console.log('Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ ÏãúÏûë...');
            try {
                const response = await fetch(GAS_WEB_APP_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(`Apps Script Error: ${data.error}`);
                }
                
                console.log('Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ ÏÑ±Í≥µ:', data);
                return data;
            } catch (error) {
                console.error('Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò§Îäî Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                logError(error, 'fetchData');
                throw error;
            }
        }
        
        // ========== ÏÉÅÌÉú Í¥ÄÎ¶¨ ==========
        
        const state = {
            currentView: 'card',
            filteredData: [],
            currentPage: 1,
            itemsPerPage: 12,
            selectedCategories: new Set(),
            searchQuery: '',
            selectedCountry: '',
            selectedCity: '',
            sortBy: 'rating',
            userLocation: null,
            isLoading: false,
            error: null
        };
        
        // ========== DOM ÏöîÏÜå ==========
        
        const elements = {
            searchInput: document.getElementById('search-input'),
            countrySelect: document.getElementById('country-select'),
            citySelect: document.getElementById('city-select'),
            sortSelect: document.getElementById('sort-select'),
            categoryChips: document.getElementById('category-chips'),
            cardViewBtn: document.getElementById('card-view-btn'),
            tableViewBtn: document.getElementById('table-view-btn'),
            resultsContainer: document.getElementById('results-container'),
            resultCount: document.getElementById('result-count'),
            paginationWrapper: document.getElementById('pagination-wrapper'),
            locationNotice: document.getElementById('location-notice')
        };
        
        let searchTimeout = null;
        
        // ========== Ï¥àÍ∏∞Ìôî ==========
        
        async function init() {
            try {
                state.isLoading = true;
                state.error = null;
                renderResults();
                
                businessData = await fetchData();
                
                state.isLoading = false;
                state.filteredData = [...businessData];
                
                populateCountries();
                populateCategories();
                setupEventListeners();
                getUserLocation();
                
                renderResults(); 
                renderPagination();
                updateResultCount();
                
                initLazyLoading();
                
            } catch (error) {
                logError(error, 'init');
                state.isLoading = false;
                state.error = 'Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§. Apps Script URLÍ≥º ÏãúÌä∏ Ïù¥Î¶ÑÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.';
                renderResults();
            }
        }
        
        // ========== ÏúÑÏπò Í∏∞Îä• ==========
        
        function getUserLocation() {
            const isInIframe = window.self !== window.top;
            
            if (!navigator.geolocation) {
                showLocationNotice('ÏúÑÏπò ÏÑúÎπÑÏä§Î•º ÏßÄÏõêÌïòÏßÄ ÏïäÎäî Î∏åÎùºÏö∞Ï†ÄÏûÖÎãàÎã§. Í±∞Î¶¨Ïàú Ï†ïÎ†¨ÏùÄ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.', 'info');
                disableDistanceSort();
                return;
            }
            
            console.log(isInIframe ? 'iframe ÌôòÍ≤ΩÏù¥ Í∞êÏßÄÎêòÏóàÏäµÎãàÎã§.' : 'ÏúÑÏπò Ï†ïÎ≥¥Îäî ÏÑ†ÌÉùÏÇ¨Ìï≠ÏûÖÎãàÎã§.');
            showLocationNotice('üí° Í±∞Î¶¨Ïàú Ï†ïÎ†¨ÏùÑ ÏõêÌïòÏãúÎ©¥ ÏïÑÎûò Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.', 'info');
            createLocationButton();
            disableDistanceSort();
        }
        
        function createLocationButton() {
            const existingButton = elements.locationNotice.querySelector('.location-btn');
            if (existingButton) return;
            
            const button = document.createElement('button');
            button.className = 'location-btn';
            button.innerHTML = 'üìç ÎÇ¥ ÏúÑÏπò ÏÇ¨Ïö©ÌïòÍ∏∞';
            
            button.addEventListener('click', requestUserLocation);
            
            elements.locationNotice.appendChild(button);
        }
        
        function requestUserLocation() {
            showLocationNotice('üìç ÏúÑÏπò Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§Îäî Ï§ë...', 'info');
            
            const options = {
                enableHighAccuracy: false,
                timeout: 10000,
                maximumAge: 300000
            };
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    state.userLocation = {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude
                    };
                    
                    businessData.forEach(business => {
                        business.distance = calculateDistance(
                            state.userLocation.latitude,
                            state.userLocation.longitude,
                            business.latitude,
                            business.longitude
                        );
                    });
                    
                    showLocationNotice('‚úÖ ÏúÑÏπò Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§! Ïù¥Ï†ú Í±∞Î¶¨Ïàú Ï†ïÎ†¨Ïù¥ Í∞ÄÎä•Ìï©ÎãàÎã§.', 'success');
                    enableDistanceSort();
                    
                    if (state.sortBy === 'distance') {
                        handleFilterChange();
                    }
                    
                    setTimeout(() => {
                        elements.locationNotice.classList.add('hidden');
                    }, 3000);
                },
                (error) => {
                    console.warn('ÏúÑÏπò Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®:', error);
                    let errorMessage = '‚ö†Ô∏è ÏúÑÏπò Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§. ';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage += 'Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ïÏóêÏÑú ÏúÑÏπò Í∂åÌïúÏùÑ ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî.'; break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage += 'ÏúÑÏπò Ï†ïÎ≥¥Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.'; break;
                        case error.TIMEOUT:
                            errorMessage += 'ÏúÑÏπò Ï†ïÎ≥¥ ÏöîÏ≤≠ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§.'; break;
                        default:
                            errorMessage += 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.';
                    }
                    showLocationNotice(errorMessage, 'error');
                    if (state.sortBy === 'distance') {
                        state.sortBy = 'rating';
                        elements.sortSelect.value = 'rating';
                        handleFilterChange();
                    }
                    disableDistanceSort();
                    setTimeout(() => {
                        elements.locationNotice.classList.add('hidden');
                    }, 10000);
                },
                options
            );
        }
        
        function disableDistanceSort() {
            const distanceOption = elements.sortSelect.querySelector('option[value="distance"]');
            if (distanceOption) {
                distanceOption.disabled = true;
                distanceOption.textContent = 'Í±∞Î¶¨Ïàú (ÏúÑÏπò Ï†ïÎ≥¥ ÌïÑÏöî)';
            }
        }
        
        function enableDistanceSort() {
            const distanceOption = elements.sortSelect.querySelector('option[value="distance"]');
            if (distanceOption) {
                distanceOption.disabled = false;
                distanceOption.textContent = 'Í±∞Î¶¨Ïàú';
            }
        }
        
        function showLocationNotice(message, type) {
            elements.locationNotice.textContent = message;
            elements.locationNotice.className = `location-notice ${type}`;
            elements.locationNotice.classList.remove('hidden');
        }
        
        // ========== Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨ ==========
        
        function populateCountries() {
            const countries = [...new Set(businessData.map(b => b.country))].sort();
            elements.countrySelect.innerHTML = '<option value="">Ï†ÑÏ≤¥ Íµ≠Í∞Ä</option>';
            countries.forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                elements.countrySelect.appendChild(option);
            });
        }
        
        function populateCities(country) {
            if (!country) {
                elements.citySelect.innerHTML = '<option value="">Íµ≠Í∞ÄÎ•º Î®ºÏ†Ä ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>';
                elements.citySelect.disabled = true;
                return;
            }
            const cities = [...new Set(
                businessData
                    .filter(b => b.country === country)
                    .map(b => b.city)
            )].sort();
            elements.citySelect.innerHTML = '<option value="">Ï†ÑÏ≤¥ ÎèÑÏãú</option>';
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                elements.citySelect.appendChild(option);
            });
            elements.citySelect.disabled = false;
        }
        
        function populateCategories() {
            const categories = new Set();
            businessData.forEach(business => {
                business.services.forEach(service => categories.add(service));
            });
            const sortedCategories = ['Ï†ÑÏ≤¥', ...Array.from(categories).sort()];
            elements.categoryChips.innerHTML = '';
            sortedCategories.forEach((category, index) => {
                const chip = document.createElement('button');
                chip.className = category === 'Ï†ÑÏ≤¥' ? 'chip all-chip' : 'chip';
                chip.setAttribute('role', 'checkbox');
                chip.setAttribute('aria-checked', category === 'Ï†ÑÏ≤¥' ? 'true' : 'false');
                chip.setAttribute('aria-label', `${category} ÏÑ†ÌÉù`);
                chip.setAttribute('tabindex', index === 0 ? '0' : '-1');
                chip.dataset.category = category;
                chip.innerHTML = `
                    <span class="chip-check">‚úì</span>
                    <span>${category === 'Ï†ÑÏ≤¥' ? '‚ú® ' : ''}${escapeHtml(category)}</span>
                `;
                chip.addEventListener('click', () => handleCategoryClick(category));
                elements.categoryChips.appendChild(chip);
            });
            state.selectedCategories.add('Ï†ÑÏ≤¥');
        }
        
        // ========== Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨ ==========
        
        function setupEventListeners() {
            elements.searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    const value = e.target.value;
                    if (validateInput(value, 200)) {
                        state.searchQuery = value.trim();
                        handleFilterChange();
                    }
                }, 300);
            });
            
            elements.countrySelect.addEventListener('change', (e) => {
                state.selectedCountry = e.target.value;
                state.selectedCity = '';
                elements.citySelect.value = '';
                populateCities(e.target.value);
                handleFilterChange();
            });
            
            elements.citySelect.addEventListener('change', (e) => {
                state.selectedCity = e.target.value;
                handleFilterChange();
            });
            
            elements.sortSelect.addEventListener('change', (e) => {
                state.sortBy = e.target.value;
                if (state.sortBy === 'distance' && !state.userLocation) {
                    showLocationNotice('‚ö†Ô∏è ÏúÑÏπò Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§. ÏúÑÏπò Í∂åÌïúÏùÑ ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                    getUserLocation();
                }
                handleFilterChange();
            });
            
            elements.cardViewBtn.addEventListener('click', () => switchView('card'));
            elements.tableViewBtn.addEventListener('click', () => switchView('table'));
            
            elements.categoryChips.addEventListener('keydown', handleChipKeyboard);
        }
        
        function handleCategoryClick(category) {
            if (category === 'Ï†ÑÏ≤¥') {
                if (state.selectedCategories.has('Ï†ÑÏ≤¥')) {
                    state.selectedCategories.clear();
                } else {
                    state.selectedCategories.clear();
                    state.selectedCategories.add('Ï†ÑÏ≤¥');
                }
            } else {
                state.selectedCategories.delete('Ï†ÑÏ≤¥');
                if (state.selectedCategories.has(category)) {
                    state.selectedCategories.delete(category);
                    if (state.selectedCategories.size === 0) {
                        state.selectedCategories.add('Ï†ÑÏ≤¥');
                    }
                } else {
                    state.selectedCategories.add(category);
                }
            }
            updateChipStates();
            handleFilterChange();
        }
        
        function updateChipStates() {
            const chips = elements.categoryChips.querySelectorAll('.chip');
            chips.forEach(chip => {
                const category = chip.dataset.category;
                const isSelected = state.selectedCategories.has(category);
                chip.setAttribute('aria-checked', isSelected ? 'true' : 'false');
            });
        }
        
        function handleChipKeyboard(e) {
            const chips = Array.from(elements.categoryChips.querySelectorAll('.chip'));
            const currentIndex = chips.findIndex(chip => chip === document.activeElement);
            if (currentIndex === -1) return;
            let newIndex = currentIndex;
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    newIndex = Math.max(0, currentIndex - 1); break;
                case 'ArrowRight':
                    e.preventDefault();
                    newIndex = Math.min(chips.length - 1, currentIndex + 1); break;
                case 'Enter':
                case ' ':
                    e.preventDefault();
                    chips[currentIndex].click(); return;
                default:
                    return;
            }
            chips.forEach((chip, idx) => {
                chip.setAttribute('tabindex', idx === newIndex ? '0' : '-1');
            });
            chips[newIndex].focus();
        }
        
        function handleFilterChange() {
            state.currentPage = 1;
            setTimeout(() => {
                try {
                    applyFilters();
                    applySorting();
                    renderResults();
                    renderPagination();
                    updateResultCount();
                } catch (error) {
                    logError(error, 'handleFilterChange');
                    showError('ÌïÑÌÑ∞ Ï†ÅÏö© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
            }, 50);
        }
        
        function applyFilters() {
            state.filteredData = businessData.filter(business => {
                if (state.searchQuery) {
                    const searchLower = state.searchQuery.toLowerCase();
                    const matchesSearch = 
                        business.businessName.toLowerCase().includes(searchLower) ||
                        business.address.toLowerCase().includes(searchLower) ||
                        business.feature.toLowerCase().includes(searchLower);
                    if (!matchesSearch) return false;
                }
                if (state.selectedCountry && business.country !== state.selectedCountry) {
                    return false;
                }
                if (state.selectedCity && business.city !== state.selectedCity) {
                    return false;
                }
                if (!state.selectedCategories.has('Ï†ÑÏ≤¥')) {
                    const hasMatchingService = business.services.some(service => 
                        state.selectedCategories.has(service)
                    );
                    if (!hasMatchingService) return false;
                }
                return true;
            });
        }
        
        function applySorting() {
            switch(state.sortBy) {
                case 'rating':
                    state.filteredData.sort((a, b) => b.rating - a.rating); break;
                case 'reviews':
                    state.filteredData.sort((a, b) => b.reviewCount - a.reviewCount); break;
                case 'distance':
                    if (state.userLocation) {
                        state.filteredData.sort((a, b) => (a.distance || 9999) - (b.distance || 9999));
                    }
                    break;
            }
        }
        
        function switchView(view) {
            state.currentView = view;
            elements.cardViewBtn.setAttribute('aria-pressed', view === 'card');
            elements.tableViewBtn.setAttribute('aria-pressed', view === 'table');
            renderResults();
        }
        
        // ========== Î†åÎçîÎßÅ ==========
        
        function renderResults() {
            try {
                elements.resultsContainer.innerHTML = '';
                
                if (state.isLoading) {
                    elements.resultsContainer.innerHTML = `
                        <div class="loading-state" role="status">
                            <div class="loading-spinner" aria-label="Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë"></div>
                            <p>Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
                        </div>
                    `;
                    return;
                }
                
                if (state.error) {
                    showError(state.error);
                    return;
                }
                
                if (state.filteredData.length === 0) {
                    const hasFilters = state.searchQuery || state.selectedCountry || 
                                     state.selectedCity || !state.selectedCategories.has('Ï†ÑÏ≤¥');
                    elements.resultsContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">${hasFilters ? 'üò¢' : 'üîç'}</div>
                            <div class="empty-message">
                                ${hasFilters ? 'Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§' : 'ÏóÖÏ≤¥Î•º Í≤ÄÏÉâÌï¥Î≥¥ÏÑ∏Ïöî'}
                            </div>
                            <div class="empty-hint">
                                ${hasFilters ? 'Îã§Î•∏ Í≤ÄÏÉâ Ï°∞Í±¥ÏùÑ ÏãúÎèÑÌï¥Î≥¥ÏÑ∏Ïöî' : 'ÏúÑÏùò ÌïÑÌÑ∞Î•º ÏÇ¨Ïö©ÌïòÏó¨ ÏóÖÏ≤¥Î•º Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî'}
                            </div>
                        </div>
                    `;
                    return;
                }
                
                const startIndex = (state.currentPage - 1) * state.itemsPerPage;
                const endIndex = startIndex + state.itemsPerPage;
                const pageData = state.filteredData.slice(startIndex, endIndex);
                
                if (state.currentView === 'card') {
                    renderCardView(pageData);
                } else {
                    renderTableView(pageData);
                }
                
                if (state.currentPage > 1) {
                    smoothScrollTo(elements.resultsContainer);
                }
                
            } catch (error) {
                logError(error, 'renderResults');
                showError('Í≤∞Í≥ºÎ•º ÌëúÏãúÌïòÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            }
        }
        
        function renderCardView(data) {
            const grid = document.createElement('div');
            grid.className = 'card-grid';
            
            data.forEach(business => {
                const card = document.createElement('article');
                card.className = 'business-card';
                card.setAttribute('role', 'article');
                card.setAttribute('aria-label', `${business.businessName} ÏóÖÏ≤¥ Ï†ïÎ≥¥`);
                
                let imgHtml = '';
                const escapedImgUrl = escapeHtml(business.image);
                const escapedAltText = escapeHtml(business.businessName);

                if (state.currentPage === 1) {
                    imgHtml = `
                        <img 
                            class="card-image loaded" 
                            src="${escapedImgUrl}" 
                            alt="${escapedAltText}"
                        />
                    `;
                } else {
                    imgHtml = `
                        <img 
                            class="card-image" 
                            data-src="${escapedImgUrl}"
                            alt="${escapedAltText}"
                            loading="lazy"
                        />
                    `;
                }
                
                const stars = generateStars(business.rating);
                const ratingHtml = `
                    <div class="rating">
                        <span class="rating-stars" aria-label="${business.rating}Ï†ê">${stars}</span>
                        <span class="rating-value">${business.rating}</span>
                        <span class="rating-count">(${business.reviewCount})</span>
                        ${business.distance !== undefined && state.userLocation ? 
                            `<span class="distance-badge">üìç ${formatDistance(business.distance)}</span>` : ''}
                    </div>
                `;
                
                const tagsHtml = business.services
                    .map(service => `<span class="tag">${escapeHtml(service)}</span>`)
                    .join('');
                
                const emailBtn = business.email ? 
                    `<a href="mailto:${escapeHtml(business.email)}" class="action-btn email" aria-label="Ïù¥Î©îÏùº">üìß</a>` : '';
                
                const websiteBtn = business.website ? 
                    `<a href="https://${escapeHtml(business.website)}" class="action-btn website" target="_blank" rel="noopener noreferrer" aria-label="ÌôàÌéòÏù¥ÏßÄ">üåê</a>` : '';
                
                card.innerHTML = `
                    ${imgHtml}
                    <div class="card-content">
                        <h3>${escapeHtml(business.businessName)}</h3>
                        ${ratingHtml}
                        <div class="card-tags">${tagsHtml}</div>
                        <p class="card-feature">${escapeHtml(business.feature)}</p>
                        <div class="card-info">
                            <div class="info-item">
                                <span class="info-icon">üìç</span>
                                <span>${escapeHtml(business.address)}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">üïê</span>
                                <span>${escapeHtml(business.hours)}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-icon">üìû</span>
                                <span>${escapeHtml(business.phone)}</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <a href="tel:${escapeHtml(business.phone)}" class="action-btn phone" aria-label="Ï†ÑÌôî">üìû</a>
                            <a href="${escapeHtml(business.googleMapsUrl)}" class="action-btn map" target="_blank" rel="noopener noreferrer" aria-label="ÏßÄÎèÑ">üìç</a>
                            ${emailBtn}
                            ${websiteBtn}
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
            
            elements.resultsContainer.appendChild(grid);
        }
        
        function renderTableView(data) {
            const container = document.createElement('div');
            container.className = 'table-container';
            
            const table = document.createElement('table');
            table.className = 'business-table';
            table.setAttribute('role', 'table');
            
            table.innerHTML = `
                <thead>
                    <tr>
                        <th scope="col">Ïù¥ÎØ∏ÏßÄ</th>
                        <th scope="col">ÏóÖÏ≤¥Î™Ö</th>
                        <th scope="col">ÌèâÏ†ê</th>
                        <th scope="col">ÏúÑÏπò</th>
                        <th scope="col">ÏÑúÎπÑÏä§</th>
                        <th scope="col">Ïó∞ÎùΩÏ≤ò</th>
                        <th scope="col">Ïï°ÏÖò</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            
            const tbody = table.querySelector('tbody');
            
            data.forEach(business => {
                const row = document.createElement('tr');
                
                let imgHtml = '';
                const escapedImgUrl = escapeHtml(business.image);
                const escapedAltText = escapeHtml(business.businessName);

                if (state.currentPage === 1) {
                    imgHtml = `
                        <img 
                            class="table-image loaded" 
                            src="${escapedImgUrl}" 
                            alt="${escapedAltText}"
                        />
                    `;
                } else {
                    imgHtml = `
                        <img 
                            class="table-image" 
                            data-src="${escapedImgUrl}"
                            alt="${escapedAltText}"
                            loading="lazy"
                        />
                    `;
                }

                const stars = generateStars(business.rating);
                const ratingHtml = `
                    <div class="rating">
                        <span class="rating-stars">${stars}</span>
                        <span class="rating-value">${business.rating}</span>
                        <span class="rating-count">(${business.reviewCount})</span>
                    </div>
                `;
                
                const tagsHtml = business.services
                    .map(service => `<span class="tag">${escapeHtml(service)}</span>`)
                    .join('');
                
                const emailBtn = business.email ? 
                    `<a href="mailto:${escapeHtml(business.email)}" class="table-action-btn email" aria-label="Ïù¥Î©îÏùº">üìß</a>` : '';
                
                const websiteBtn = business.website ? 
                    `<a href="https://${escapeHtml(business.website)}" class="table-action-btn website" target="_blank" rel="noopener noreferrer" aria-label="ÌôàÌéòÏù¥ÏßÄ">üåê</a>` : '';
                
                row.innerHTML = `
                    <td>${imgHtml}</td>
                    <td><strong>${escapeHtml(business.businessName)}</strong></td>
                    <td>${ratingHtml}</td>
                    <td>${escapeHtml(business.city)}, ${escapeHtml(business.country)}</td>
                    <td><div class="table-tags">${tagsHtml}</div></td>
                    <td>${escapeHtml(business.phone)}</td>
                    <td>
                        <div class="table-actions">
                            <a href="tel:${escapeHtml(business.phone)}" class="table-action-btn phone" aria-label="Ï†ÑÌôî">üìû</a>
                            <a href="${escapeHtml(business.googleMapsUrl)}" class="table-action-btn map" aria-label="ÏßÄÎèÑ" target="_blank" rel="noopener noreferrer">üìç</a>
                            ${emailBtn}
                            ${websiteBtn}
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            container.appendChild(table);
            elements.resultsContainer.appendChild(container);
        }
        
        function updateResultCount() {
            const count = state.filteredData.length;
            const selectedCount = state.selectedCategories.size - (state.selectedCategories.has('Ï†ÑÏ≤¥') ? 1 : 0);
            const badge = selectedCount > 0 ? 
                `<span class="selected-badge" aria-label="${selectedCount}Í∞ú ÏóÖÏ¢Ö ÏÑ†ÌÉùÎê®">${selectedCount}</span>` : '';
            elements.resultCount.innerHTML = `
                Í≤ÄÏÉâ Í≤∞Í≥º: <strong>${count}Í∞ú</strong>
                ${badge}
            `;
        }
        
        function renderPagination() {
            if (state.filteredData.length === 0) {
                elements.paginationWrapper.innerHTML = '';
                return;
            }
            const totalPages = Math.ceil(state.filteredData.length / state.itemsPerPage);
            if (totalPages <= 1) {
                elements.paginationWrapper.innerHTML = '';
                return;
            }
            const wrapper = document.createElement('div');
            wrapper.innerHTML = `
                <div class="items-per-page">
                    <label for="items-per-page-select">ÌéòÏù¥ÏßÄÎãπ Ìï≠Î™©:</label>
                    <select id="items-per-page-select" aria-label="ÌéòÏù¥ÏßÄÎãπ ÌëúÏãúÌï† Ìï≠Î™© Ïàò">
                        <option value="12" ${state.itemsPerPage === 12 ? 'selected' : ''}>12Í∞ú</option>
                        <option value="20" ${state.itemsPerPage === 20 ? 'selected' : ''}>20Í∞ú</option>
                        <option value="50" ${state.itemsPerPage === 50 ? 'selected' : ''}>50Í∞ú</option>
                        <option value="100" ${state.itemsPerPage === 100 ? 'selected' : ''}>100Í∞ú</option>
                    </select>
                </div>
                <nav class="pagination" role="navigation" aria-label="ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò"></nav>
            `;
            const pagination = wrapper.querySelector('.pagination');
            const prevBtn = createPageButton('‚Äπ Ïù¥Ï†Ñ', state.currentPage - 1, state.currentPage === 1);
            pagination.appendChild(prevBtn);
            const pageNumbers = getSmartPageNumbers(state.currentPage, totalPages);
            pageNumbers.forEach(page => {
                if (page === '...') {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'page-ellipsis';
                    ellipsis.textContent = '...';
                    ellipsis.setAttribute('aria-hidden', 'true');
                    pagination.appendChild(ellipsis);
                } else {
                    const btn = createPageButton(page.toString(), page, false, page === state.currentPage);
                    pagination.appendChild(btn);
                }
            });
            const nextBtn = createPageButton('Îã§Ïùå ‚Ä∫', state.currentPage + 1, state.currentPage === totalPages);
            pagination.appendChild(nextBtn);
            elements.paginationWrapper.innerHTML = '';
            elements.paginationWrapper.appendChild(wrapper);
            const itemsSelect = wrapper.querySelector('#items-per-page-select');
            itemsSelect.addEventListener('change', (e) => {
                state.itemsPerPage = parseInt(e.target.value);
                state.currentPage = 1;
                renderResults();
                renderPagination();
            });
        }
        
        function createPageButton(text, page, disabled = false, current = false) {
            const btn = document.createElement('button');
            btn.className = 'page-btn';
            btn.textContent = text;
            btn.disabled = disabled;
            if (current) {
                btn.setAttribute('aria-current', 'page');
                btn.setAttribute('aria-label', `ÌòÑÏû¨ ÌéòÏù¥ÏßÄ, ÌéòÏù¥ÏßÄ ${page}`);
            } else {
                btn.setAttribute('aria-label', `ÌéòÏù¥ÏßÄ ${page}Î°ú Ïù¥Îèô`);
            }
            if (!disabled && !current) {
                btn.addEventListener('click', () => {
                    state.currentPage = page;
                    renderResults();
                    renderPagination();
                });
            }
            return btn;
        }
        
        function getSmartPageNumbers(current, total) {
            const pages = [];
            const delta = 2;
            for (let i = 1; i <= total; i++) {
                if (i === 1 || i === total || (i >= current - delta && i <= current + delta)) {
                    pages.push(i);
                } else if (pages[pages.length - 1] !== '...') {
                    pages.push('...');
                }
            }
            return pages;
        }
        
        function showError(message) {
            elements.resultsContainer.innerHTML = `
                <div class="error-state" role="alert">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <div class="error-message">Ïò§Î•ò Î∞úÏÉù</div>
                    <div class="error-details">${escapeHtml(message)}</div>
                </div>
            `;
        }
        
        // ========== Ïù¥ÎØ∏ÏßÄ Lazy Loading ==========
        
        function initLazyLoading() {
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            loadImage(img);
                            observer.unobserve(img);
                        }
                    });
                }, {
                    rootMargin: '100px 0px',
                    threshold: 0.01
                });
                
                const mutationObserver = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeType === 1) {
                                const images = node.querySelectorAll ? 
                                    node.querySelectorAll('img[data-src]') : 
                                    (node.tagName === 'IMG' && node.hasAttribute('data-src') ? [node] : []);
                                
                                images.forEach(img => imageObserver.observe(img));
                            }
                        });
                    });
                });
                
                mutationObserver.observe(elements.resultsContainer, {
                    childList: true,
                    subtree: true
                });
                
            } else {
                const loadAllImages = () => {
                    const images = elements.resultsContainer.querySelectorAll('img[data-src]');
                    images.forEach(img => loadImage(img));
                };
                
                const mutationObserver = new MutationObserver(loadAllImages);
                mutationObserver.observe(elements.resultsContainer, {
                    childList: true,
                    subtree: true
                });
            }
        }
        
        function loadImage(img) {
            const src = img.getAttribute('data-src');
            if (!src || img.src) return; 
            
            img.classList.add('lazy-loading');
            
            const tempImg = new Image();
            
            tempImg.onload = function() {
                img.src = src;
                img.classList.remove('lazy-loading');
                img.classList.add('loaded');
                img.removeAttribute('data-src');
            };
            
            tempImg.onerror = function() {
                img.src = 'data:image/svg+xml;charset=UTF-8,%3csvg xmlns="http://www.w3.org/2000/svg" width="600" height="400" viewBox="0 0 600 400"%3e%3crect fill="%23f7fafc" width="600" height="400"/%3e%3ctext x="50%25" y="50%25" text-anchor="middle" fill="%23718096" font-size="16" font-family="sans-serif"%3eÏù¥ÎØ∏ÏßÄÎ•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§%3c/text%3e%3c/svg%3e';
                img.classList.remove('lazy-loading');
                img.classList.add('loaded');
                img.removeAttribute('data-src');
            };
            
            tempImg.src = src;
        }
        
        // ========== Ïï± ÏãúÏûë ==========
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
        
    })();
    </script>
</body>
</html>
